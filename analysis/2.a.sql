-- 1.a. Analyze how much money is spent per month, quarter, year
SELECT SUM(p.[amount]),
[year], [month]
FROM [fact_payments] p
JOIN [dates] d
    ON p.[date] = d.[datetime]
GROUP BY [year], [month]
ORDER BY [year], [month]

-- Output:
-- ,year,month
-- 51.60,2013,2
-- 67873.25,2013,3
-- 294386.40,2013,4
-- 722644.86,2013,5
-- 1415737.50,2013,6
-- 2251934.08,2013,7
-- 3413065.50,2013,8
-- 4557044.30,2013,9
-- 6364098.84,2013,10
-- 8432227.65,2013,11
-- 10659573.00,2013,12
-- 13226800.92,2014,1
-- 15806659.52,2014,2
-- 18284401.76,2014,3
-- 23472336.47,2014,4
-- 28059623.90,2014,5
-- 32816298.48,2014,6
-- 37814679.45,2014,7
-- 43558589.85,2014,8
-- 50798227.15,2014,9
-- 57232931.91,2014,10
-- 65606746.35,2014,11
-- 73689115.50,2014,12
-- 85755769.56,2015,1
-- 94242094.80,2015,2
-- 107277567.78,2015,3
-- 119104950.40,2015,4
-- 131232342.23,2015,5
-- 147702607.36,2015,6
-- 163826666.64,2015,7
-- 179576180.68,2015,8
-- 195934299.00,2015,9
-- 217530882.25,2015,10
-- 243555431.31,2015,11
-- 267510874.68,2015,12
-- 291641930.19,2016,1
-- 323595525.18,2016,2
-- 350346067.92,2016,3
-- 381639801.15,2016,4
-- 415367208.00,2016,5
-- 451966216.68,2016,6
-- 488046448.89,2016,7
-- 534318500.52,2016,8
-- 566539956.36,2016,9
-- 613888509.00,2016,10
-- 666708615.72,2016,11
-- 719586677.53,2016,12
-- 779086002.50,2017,1
-- 841467135.96,2017,2
-- 902046522.00,2017,3
-- 980635648.00,2017,4
-- 1044632200.32,2017,5
-- 1120230442.87,2017,6
-- 1211134946.94,2017,7
-- 1320393959.14,2017,8
-- 1424523885.40,2017,9
-- 1527345407.70,2017,10
-- 1653528693.52,2017,11
-- 1771774704.18,2017,12
-- 1897884141.30,2018,1
-- 2041456020.36,2018,2
-- 2175320566.63,2018,3
-- 2327425378.08,2018,4
-- 2515582560.96,2018,5
-- 2689475546.16,2018,6
-- 2852139133.62,2018,7
-- 3065871409.71,2018,8
-- 3247942644.96,2018,9
-- 3484203148.30,2018,10
-- 3710611724.76,2018,11
-- 3980542302.36,2018,12
-- 4279813770.24,2019,1
-- 4579692022.40,2019,2
-- 4867815787.47,2019,3
-- 5214808531.02,2019,4
-- 5552551395.36,2019,5
-- 5946990456.00,2019,6
-- 6356227033.10,2019,7
-- 6740236805.88,2019,8
-- 7232988954.67,2019,9
-- 7692580025.91,2019,10
-- 8190953356.04,2019,11
-- 8706487359.44,2019,12
-- 9277189550.40,2020,1
-- 9863887585.00,2020,2
-- 10452084814.51,2020,3
-- 11117169689.42,2020,4
-- 11727956421.84,2020,5
-- 12448151835.93,2020,6
-- 13238970522.72,2020,7
-- 14103143641.95,2020,8
-- 14991593675.54,2020,9
-- 15974437703.00,2020,10
-- 16938322501.24,2020,11
-- 17905185648.00,2020,12
-- 19079540584.32,2021,1
-- 20179109687.00,2021,2
-- 21262811142.82,2021,3
-- 22494534403.78,2021,4
-- 23849300894.25,2021,5
-- 25334466409.20,2021,6
-- 26695692345.79,2021,7
-- 28164701795.40,2021,8
-- 29685937971.69,2021,9
-- 31325140825.00,2021,10
-- 32744440601.18,2021,11
-- 34289252804.16,2021,12
-- 35834442738.30,2022,1
-- 36519190297.13,2022,2
