-- 1.b. Analyze how much money is spent
--      per member, based on the age of the rider at account start

SELECT SUM([amount]),
    [rider_age]
FROM [fact_payments] p
JOIN [riders] r
    ON p.[rider_id] = r.[rider_id]
GROUP BY [rider_age]
ORDER BY [rider_age]

-- Output
-- total_spending,rider_age
-- 2142.00,7
-- 39839.29,8
-- 75888.31,9
-- 132597.65,10
-- 211035.61,11
-- 262744.39,12
-- 379045.77,13
-- 449002.06,14
-- 555405.86,15
-- 594260.17,16
-- 567905.79,17
-- 608348.16,18
-- 640723.37,19
-- 638381.98,20
-- 664604.80,21
-- 663244.46,22
-- 648490.98,23
-- 640505.78,24
-- 644520.31,25
-- 671988.84,26
-- 665471.46,27
-- 644543.86,28
-- 606989.40,29
-- 580147.51,30
-- 564023.61,31
-- 558940.59,32
-- 556321.80,33
-- 548747.72,34
-- 522110.40,35
-- 434687.97,36
-- 414804.16,37
-- 397561.23,38
-- 397424.46,39
-- 339930.66,40
-- 320745.79,41
-- 301948.42,42
-- 273961.86,43
-- 261121.85,44
-- 213536.35,45
-- 227470.55,46
-- 194999.63,47
-- 177832.58,48
-- 160347.27,49
-- 130573.50,50
-- 113797.37,51
-- 112259.06,52
-- 93339.96,53
-- 88894.77,54
-- 72465.83,55
-- 66977.37,56
-- 57277.72,57
-- 39105.22,58
-- 39142.56,59
-- 34992.33,60
-- 25315.43,61
-- 18791.93,62
-- 22497.32,63
-- 17809.66,64
-- 16461.73,65
-- 12793.25,66
-- 11535.70,67
-- 7509.23,68
-- 6320.87,69
-- 4161.71,70
-- 4824.00,71
-- 2267.58,72
-- 1931.39,73
-- 1399.17,74
-- 315.88,75
